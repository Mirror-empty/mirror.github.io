# 01.事务

### 概念
事务指的是满足ACID特性的一组操作，可以通过Commit提交一个事务，也可以使用Rollback回滚。

在数据库系统中，一个事务是指：由一系列数据库操作组成的一个完整的逻辑过程。例如银行转帐，从原账户扣除金额，以及向目标账户添加金额，这两个数据库操作的总和，构成一个完整的逻辑过程，不可拆分。这个过程被称为一个事务，具有ACID特性。

![zXDOWn.png](https://s1.ax1x.com/2022/12/22/zXDOWn.png)

### ACID

**1.原子性（Atomicity）**

事务被视为不可分割的最小单元，事务的所有操作要么全部提交成功，要么全部失败回滚。

回滚可以用回滚日志（Undo Log）来实现，回滚日志记录着事务所执行的修改操作，在回滚时反向执行这些修改操作即可。


**2.一致性（Consistency）**

数据库在事务执行前后保持一致性状态。在一致性状态下，所有事务对同一个数据的读取结果都是相同的。


**3.隔离性（lsolation）**

一个事务所做的修改在最终提交以前，对其他事务是不可见的。


**4.持久性（Durability）**

一旦事务提交，则其所做的修改将会永远保持到数据库中。即使系统发生崩溃，事务执行的结果也不能丢失。

系统发生崩溃可以同重做日志（Redo Log）进行恢复，从而实现持久性。与回滚日志记录数据的逻辑修改不同，重做日志记录的是数据页的物理修改。

事务的ACID特性概念简单，但不是很好理解，主要是因为这几个特性不是一种平级关系：

- 只有满足一致性，事务的执行结果才是正确的。
- 在无并发的情况下，事务串行执行，隔离性一定能够满足，此时只有能满足原子性，就一定能满足一致性。
- 在并发的情况下，多个事务并行执行，事务不仅要满足原子性，还需要满足隔离性，才能满足一致性。
- 事务满足持久化是为了能应对系统崩溃的情况。

![zXrpeU.png](https://s1.ax1x.com/2022/12/22/zXrpeU.png)

### AUTOCOMMIT

MySQL 默认采用自动提交模式。也就是说，如果不显式使用START 
TRANSACTION语句来开始一个事务，那么每个查询操作都会被当做一个事
务并自动提交。


